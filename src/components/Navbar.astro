---
// Importaciones usadas (eliminadas las redundantes)
import type { HTMLAttributes } from 'astro/types';

// Props tipadas
interface Props extends HTMLAttributes<'nav'> {
  logo?: string;
}

const { logo, ...attrs } = Astro.props;
---

<nav {...attrs} class={`flex items-center justify-between p-4 ${attrs.class || ''}`}>
  <!-- Logo -->
  {logo && (
    <a href="/" class="flex items-center">
      <img src={logo} alt="Logo" class="h-10" />
    </a>
  )}

  <!-- Menú Desktop -->
  <div class="hidden md:flex gap-6">
    <a href="/" class="hover:text-primary">Inicio</a>
    <a href="/about" class="hover:text-primary">Sobre mí</a>
    <div class="relative dropdown-container">
      <button 
        class="hover:text-primary flex items-center"
        on:click={(e) => handleDropdown(e)}
      >
        Proyectos <span class="ml-1">▼</span>
      </button>
      <div class="absolute hidden bg-white shadow-lg rounded mt-2 p-2">
        <a href="/projects/web" class="block px-4 py-2 hover:bg-gray-100">Web</a>
        <a href="/projects/mobile" class="block px-4 py-2 hover:bg-gray-100">Mobile</a>
      </div>
    </div>
  </div>

  <!-- Menú Mobile -->
  <button id="mobile-menu-button" class="md:hidden">
    ☰
  </button>

  <script>
    // Función corregida con tipos TypeScript
    const handleDropdown = (event: MouseEvent) => {
      const target = event.currentTarget as HTMLElement;
      const dropdownMenu = target.nextElementSibling as HTMLElement | null;
      
      if (dropdownMenu) {
        dropdownMenu.classList.toggle('hidden');
      }
    };

    // Cerrar menú al hacer clic fuera
    document.addEventListener('click', (e: MouseEvent) => {
      const target = e.target as HTMLElement;
      if (!target.closest('.dropdown-container')) {
        document.querySelectorAll('.dropdown-container + div').forEach((menu) => {
          menu.classList.add('hidden');
        });
      }
    });

    // Menú móvil
    const mobileButton = document.getElementById('mobile-menu-button');
    mobileButton?.addEventListener('click', () => {
      const menu = document.querySelector('.md\\:hidden');
      menu?.classList.toggle('hidden');
    });
  </script>
</nav>
